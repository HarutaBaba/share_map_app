<h1>ShareMap</h1>
<div id='map'></div>



<style>
#map{
  height: 700px;
}
</style>

<script>
var map;
var marker;
var infoWindow;
var center = {
  lat: 34.7019399, // 緯度
  lng: 135.51002519999997 // 経度
};
// 地図を埋め込む
function initMap() {
 map = new google.maps.Map(document.getElementById('map'), { // #mapに地図を埋め込む
     center: center, // 地図の中心を指定
     zoom: 19 // 地図のズームを指定
   });
 
 //mapをクリックしたときのイベントを設定
  google.maps.event.addListener(map, 'click', mylistener);

       //クリックしたときの処理
   function mylistener(event){
        marker = new google.maps.Marker();
        //markerの位置を設定
    	 //event.latLng.lat()でクリックしたところの緯度を取得
    	 marker.setPosition(new google.maps.LatLng(event.latLng.lat(), event.latLng.lng()));
      	//marker設置
    	  marker.setMap(map);
     	 infoWindow = new google.maps.InfoWindow({ // 吹き出しの追加
          content: '<div><%= @title %><br/><%= @time %><br/><%= @status %></div>' // 吹き出しに表示する内容
       	});
     	  markerEvent(); // マーカーにクリックイベントを追加
   }
       
   function markerEvent() {
      marker.addListener('click', function() { // マーカーをクリックしたとき
        infoWindow.open(map, marker); // 吹き出しの表示
      });
   }
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmSQvPRnvLiANGb7VflD3ZD1R4zWiqYC4&callback=initMap" async defer></script>

<% if @title.nil? %>
<%= form_tag(root_path, method: :post) do %>
  <%= label_tag(:title, "タイトル")  %>
　<%= text_field_tag "title","" ,class: 'form-control' %>
　<%= label_tag(:time, "日付")  %>
　<%= text_field_tag "time",""  ,class: 'form-control'%>
　<%= label_tag(:gender, "募集する")  %>
　<%= radio_button_tag(:gender, "募集する") %>
　<%= label_tag(:gender, "募集しない") %>
  <%= radio_button_tag(:gender, "募集しない") %>
　<%= submit_tag "位置を登録する", class: "btn btn-primary" %>
<% end %>
<% else %>
 <%= current_user.name %>
 <%= @title %>
 <%= @time %>
 <%= @gender %>

 <% @plan = Plan.new unless @plan %>
 <%= form_for(@plan, url: new_plan_path) do |f| %>
  <%= f.hidden_field :name, :value => current_user.name %>
  <%= f.hidden_field :title, :value => @title %>
  <%= f.hidden_field :time, :value => @time %>
  <%= f.hidden_field :gender, :value => @gender %>
  <%= f.submit "予定情報を登録する", class: "btn btn-primary" %>
 <% end %>

<% end %>